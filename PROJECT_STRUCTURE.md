LabPrinter - Windows ç½‘ç»œæ‰“å°ç³»ç»Ÿ
â”‚
â”œâ”€â”€ ğŸ“„ README.md                    # é¡¹ç›®ç®€ä»‹
â”œâ”€â”€ ğŸ“‹ QUICKSTART.md                # å¿«é€Ÿå¼€å§‹æŒ‡å—
â”œâ”€â”€ ğŸ—ï¸  TECHNICAL_DESIGN.md         # æŠ€æœ¯è®¾è®¡æ–‡æ¡£
â”œâ”€â”€ ğŸ”— API.md                       # APIæ¥å£æ–‡æ¡£
â”œâ”€â”€ ğŸ“¦ requirements.txt             # Pythonä¾èµ–åŒ…åˆ—è¡¨
â”‚
â”œâ”€â”€ ğŸš€ run.py                       # åº”ç”¨å¯åŠ¨å…¥å£
â”œâ”€â”€ âš™ï¸  config.py                   # å…¨å±€é…ç½®æ–‡ä»¶
â”‚
â”œâ”€â”€ ğŸ“‚ app/                         # Flaskåº”ç”¨åŒ…
â”‚   â”œâ”€â”€ __init__.py                 # åº”ç”¨å·¥å‚ + Workerå¯åŠ¨
â”‚   â”œâ”€â”€ routes.py                   # Webè·¯ç”± (GET/POST)
â”‚   â”œâ”€â”€ task_queue.py               # çº¿ç¨‹å®‰å…¨ä»»åŠ¡é˜Ÿåˆ—
â”‚   â”œâ”€â”€ print_worker.py             # åå°æ‰“å°Workerçº¿ç¨‹
â”‚   â”œâ”€â”€ converter.py                # Wordâ†’PDFè½¬æ¢ (COM)
â”‚   â”œâ”€â”€ printer.py                  # Windowsæ‰“å°æ¥å£
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“‚ templates/
â”‚       â””â”€â”€ index.html              # Webå‰ç«¯ç•Œé¢
â”‚
â”œâ”€â”€ ğŸ“‚ deploy/                      # éƒ¨ç½²ç›¸å…³æ–‡ä»¶
â”‚   â”œâ”€â”€ install.ps1                 # PowerShellä¸€é”®å®‰è£…è„šæœ¬
â”‚   â””â”€â”€ start.bat                   # Windowsæ‰¹å¤„ç†å¯åŠ¨è„šæœ¬
â”‚
â””â”€â”€ ğŸ“‚ tests/                       # å•å…ƒæµ‹è¯•
    â””â”€â”€ test_app.py                 # æµ‹è¯•ç”¨ä¾‹

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## æ ¸å¿ƒæ¨¡å—è¯´æ˜

### åº”ç”¨å¯åŠ¨æµç¨‹
run.py â†’ app/__init__.py â†’ create_app()
  â”œâ”€ åŠ è½½configé…ç½®
  â”œâ”€ åˆ›å»ºFlaskåº”ç”¨
  â”œâ”€ æ³¨å†Œroutesè“å›¾
  â”œâ”€ å¯åŠ¨start_worker()
  â”‚   â””â”€ åˆ›å»º3ä¸ªPrintWorkerçº¿ç¨‹
  â”‚       â””â”€ æ¯ä¸ªçº¿ç¨‹ç›‘å¬ä»»åŠ¡é˜Ÿåˆ—
  â””â”€ åº”ç”¨å°±ç»ªï¼Œç›‘å¬0.0.0.0:5000

### è¯·æ±‚å¤„ç†æµç¨‹
ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶
  â†“ (HTTP POST /upload)
routes.py::upload()
  â”œâ”€ æ–‡ä»¶æœ‰æ•ˆæ€§æ£€æŸ¥
  â”œâ”€ å®‰å…¨æ–‡ä»¶åç”Ÿæˆ
  â”œâ”€ ä¿å­˜åˆ°ç£ç›˜
  â”œâ”€ åˆ›å»ºTaskå¯¹è±¡
  â”œâ”€ task_queue.submit()
  â”‚   â””â”€ åŠ å…¥queue.Queue
  â””â”€ è¿”å›task_idç»™æµè§ˆå™¨

### åå°å¤„ç†æµç¨‹
PrintWorker (åå°çº¿ç¨‹)
  â””â”€ while True:
      â”œâ”€ task_queue.get_next()  # é˜»å¡ç­‰å¾…
      â”œâ”€ è·å–Taskå¯¹è±¡
      â”œâ”€ æ›´æ–°state â†’ PROGRESS
      â”œâ”€ è°ƒç”¨_process_task()
      â”‚   â”œâ”€ æ–‡æ¡£è½¬æ¢ (å¦‚æœæ˜¯Word)
      â”‚   â”‚   â””â”€ converter.convert_to_pdf()
      â”‚   â”‚       â””â”€ Word COMè‡ªåŠ¨åŒ–
      â”‚   â”œâ”€ æ‰“å°å‘é€
      â”‚   â”‚   â””â”€ printer.print_file()
      â”‚   â”‚       â””â”€ win32api.ShellExecute()
      â”‚   â””â”€ æ–‡ä»¶æ¸…ç†
      â”‚       â””â”€ os.remove()
      â””â”€ æ›´æ–°state â†’ SUCCESS/FAILURE

### çŠ¶æ€æŸ¥è¯¢æµç¨‹
ç”¨æˆ·è½®è¯¢æŸ¥è¯¢
  â†“ (HTTP GET /status/<task_id>)
routes.py::task_status()
  â””â”€ task_queue.get_task(task_id)
      â””â”€ è¿”å›å½“å‰TaskçŠ¶æ€
          â”œâ”€ state (PENDING/PROGRESS/SUCCESS/FAILURE)
          â”œâ”€ message (çŠ¶æ€æ¶ˆæ¯)
          â”œâ”€ progress (è¿›åº¦ç™¾åˆ†æ¯”)
          â””â”€ result/error (ç»“æœä¿¡æ¯)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ä¾èµ–åŒ…è¯´æ˜

| åŒ…å | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| flask | â‰¥3.0.0 | Webæ¡†æ¶ |
| pywin32 | â‰¥306 | Windows APIè®¿é—® |
| comtypes | â‰¥1.4.0 | COMè‡ªåŠ¨åŒ–åº“ |
| PyMuPDF | â‰¥1.24.0 | PDFå¤„ç† |

### ä¸ºä»€ä¹ˆè¿™ä¸ªç»„åˆ?

âœ“ **Flask** - è½»é‡çº§ï¼Œæ— éœ€å¤–éƒ¨ä¾èµ–ï¼ˆå¦‚Redisï¼‰
âœ“ **pywin32** - è®¿é—®Windowsæ‰“å°ç³»ç»ŸåŸç”ŸAPI
âœ“ **comtypes** - Word COMè‡ªåŠ¨åŒ–ï¼Œè´¨é‡æœ€é«˜çš„è½¬æ¢æ–¹å¼
âœ“ **PyMuPDF** - é«˜æ•ˆPDFå¤„ç†åº“

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## æ–‡ä»¶å¤§å°ä¼°ç®—

| æ–‡ä»¶ | å¤§å° | è¯´æ˜ |
|------|------|------|
| config.py | <1KB | é…ç½® |
| run.py | <1KB | å¯åŠ¨è„šæœ¬ |
| app/__init__.py | ~1KB | åº”ç”¨å·¥å‚ |
| app/routes.py | ~3KB | è·¯ç”±é€»è¾‘ |
| app/task_queue.py | ~4KB | é˜Ÿåˆ—ç®¡ç† |
| app/print_worker.py | ~3KB | Workerçº¿ç¨‹ |
| app/converter.py | ~2KB | æ–‡æ¡£è½¬æ¢ |
| app/printer.py | ~4KB | æ‰“å°æ¥å£ |
| templates/index.html | ~8KB | å‰ç«¯ç•Œé¢ |
| **é¡¹ç›®ä»£ç æ€»è®¡** | **~30KB** | æå° |
| deploy/*.ps1/*.bat | <2KB | éƒ¨ç½²è„šæœ¬ |
| æ‰€æœ‰ä¾èµ–åŒ… | ~150MB | è™šæ‹Ÿç¯å¢ƒ |

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•